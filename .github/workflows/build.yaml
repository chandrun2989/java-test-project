name: "build test"

on:
  workflow_dispatch:


jobs:
  maven_test:
    runs-on: self-hosted

    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Set up Snyk CLI
        uses: snyk/actions/setup@master
        with:
          snyk-version: latest
      
      - name: Set up JDK 17
        uses: actions/setup-java@v4
        with:
          java-version: '17'
          distribution: 'temurin'
          server-id: nexus-snapshots # ID from the settings.xml to match 
          server-username: MAVEN_USERNAME # Env var name we will map below
          server-password: MAVEN_PASSWORD # Env var name we will map below

      
      - name: Publish to Nexus
        run: mvn deploy -DskipTests
        env:
          MAVEN_USERNAME: ${{ secrets.NEXUS_USERNAME }}
          MAVEN_PASSWORD: ${{ secrets.NEXUS_PASSWORD }}